{"ast":null,"code":"import _toConsumableArray from\"C:/Users/tuu18/Documents/csc309/team63/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"C:/Users/tuu18/Documents/csc309/team63/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/tuu18/Documents/csc309/team63/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/tuu18/Documents/csc309/team63/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import EditCoverPhoto from'../EditCoverPhoto';import\"./styles.css\";import FormRow from'../FormRow';import SelectCategories from'../SelectCategories';import SelectReference from'../SelectReference';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EditWorkDetails(props){var defaultSelectedReferences=props.currentPost.references.map(function(work){return{name:work.name,id:work.workId};});var defaultFormInputs={title:props.currentPost.title,references:props.currentPost.references,categories:props.currentPost.categories,hashtags:props.currentPost.tags,audio:props.currentPost.audio,description:props.currentPost.description,coverImage:props.currentPost.imgSrc};var _useState=useState(defaultFormInputs),_useState2=_slicedToArray(_useState,2),uploadFormInputs=_useState2[0],setUploadFormInputs=_useState2[1];var _useState3=useState(\"Click this area to select a file\"),_useState4=_slicedToArray(_useState3,2),audioLabel=_useState4[0],setAudioLabel=_useState4[1];var _useState5=useState([defaultSelectedReferences]),_useState6=_slicedToArray(_useState5,2),selectedRefWork=_useState6[0],setSelectedRefWork=_useState6[1];var downloads=props.currentUser.downloadedWorks.map(function(work){return{name:work.title+\" - \"+work.artist,id:work.id};});var saveChanges=function saveChanges(){props.setInfo(['title',uploadFormInputs.title]);props.setInfo(['references',uploadFormInputs.references]);props.setInfo(['categories',uploadFormInputs.categories]);props.setInfo(['hashtags',uploadFormInputs.hashtags]);props.setInfo(['audio',uploadFormInputs.audio]);props.setInfo(['description',uploadFormInputs.description]);props.setInfo(['imgSrc',uploadFormInputs.coverImage]);};var handleInputChange=function handleInputChange(event){var name=event.target.name;var value;if(name===\"hashtags\"){value=event.target.value.split(/[ #]+/);}else if(name===\"coverImage\"){var image=event.target.files[0];if(image){value=URL.createObjectURL(image);}else{return;}}else{value=event.target.value;}setUploadFormInputs(function(inputs){return _objectSpread(_objectSpread({},inputs),{},_defineProperty({},name,value));});};var handleCategoryChange=function handleCategoryChange(categoriesList){var name='categories';setUploadFormInputs(function(inputs){return _objectSpread(_objectSpread({},inputs),{},_defineProperty({},name,categoriesList));});};var handleRefAdd=function handleRefAdd(event){event.preventDefault();var references=[].concat(_toConsumableArray(uploadFormInputs.references),[{workId:null,description:\"\"}]);var name='references';setUploadFormInputs(function(inputs){return _objectSpread(_objectSpread({},inputs),{},_defineProperty({},name,references));});var works=[].concat(_toConsumableArray(selectedRefWork),[[]]);setSelectedRefWork(works);};var handleRefRemove=function handleRefRemove(idx,event){event.preventDefault();var name='references';var references=_toConsumableArray(uploadFormInputs.references);references.splice(idx,1);setUploadFormInputs(function(inputs){return _objectSpread(_objectSpread({},inputs),{},_defineProperty({},name,references));});var works=_toConsumableArray(selectedRefWork);works.splice(idx,1);setSelectedRefWork(works);};var handleAudioChange=function handleAudioChange(event){if(event.target.files.length){console.log(event.target.files);var name=\"audio\";var value=URL.createObjectURL(event.target.files[0]);setUploadFormInputs(function(inputs){return _objectSpread(_objectSpread({},inputs),{},_defineProperty({},name,value));});setAudioLabel(event.target.files[0].name);}};var handleRefSelect=function handleRefSelect(idx,workId,selectedWork){var references=_toConsumableArray(uploadFormInputs.references);references[idx].workId=workId;var name='references';setUploadFormInputs(function(inputs){return _objectSpread(_objectSpread({},inputs),{},_defineProperty({},name,references));});var works=_toConsumableArray(selectedRefWork);works[idx]=selectedWork;setSelectedRefWork(works);};var handleDescriptionChange=function handleDescriptionChange(idx,event){var references=_toConsumableArray(uploadFormInputs.references);references[idx].description=event.target.value;var name='references';setUploadFormInputs(function(inputs){return _objectSpread(_objectSpread({},inputs),{},_defineProperty({},name,references));});};var handleUpload=function handleUpload(event){event.preventDefault();//a post request will be made with the form data\nsetUploadFormInputs(defaultFormInputs);setSelectedRefWork([[]]);return alert(\"Your work was successfully uploaded\");};return/*#__PURE__*/_jsxs(\"div\",{id:\"edit-upload-page\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"work-details\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"header-container\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"page-title\",children:\"Edit Post\"})}),/*#__PURE__*/_jsx(\"div\",{id:\"details-container\",children:/*#__PURE__*/_jsxs(\"form\",{id:\"upload-form\",children:[/*#__PURE__*/_jsx(FormRow,{label:\"Title\",type:\"text\",className:\"input-box\",value:uploadFormInputs.title,handleChange:handleInputChange,name:\"title\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"input-label\",children:\"Categories\"}),/*#__PURE__*/_jsx(SelectCategories,{selectedValues:uploadFormInputs.categories,disabled:false,handleSelect:handleCategoryChange})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(FormRow,{label:\"Hashtags\",type:\"text\",className:\"input-box\",value:uploadFormInputs.hashtags.join(\" #\"),handleChange:handleInputChange,name:\"hashtags\",placeholder:\"#hashtag1 #hashtag2\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"input-label\",children:\"Audio File\"}),/*#__PURE__*/_jsx(\"label\",{className:\"input-box\",id:\"audio-file-label\",htmlFor:\"audio-file\",children:audioLabel}),/*#__PURE__*/_jsx(\"input\",{id:\"audio-file\",type:\"file\",accept:\".mp3, .wav\",onChange:handleAudioChange})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"input-label\",children:\"Description\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"description-text-box\",name:\"description\",value:uploadFormInputs.description,onChange:handleInputChange})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"input-label\",children:\"Referenced Works\"}),uploadFormInputs.references.map(function(ref,idx){return/*#__PURE__*/_jsxs(\"div\",{className:\"add-ref-box\",children:[/*#__PURE__*/_jsx(SelectReference,{options:downloads,selectedOptions:selectedRefWork[idx],handleSelect:function handleSelect(selectedWork){return handleRefSelect(idx,selectedWork.length?selectedWork[0].id:\"\",selectedWork);}}),/*#__PURE__*/_jsx(\"textarea\",{className:\"description-text-box ref-description\",name:\"description\",value:uploadFormInputs.references[idx].description,onChange:function onChange(event){return handleDescriptionChange(idx,event);},placeholder:\"How did you use this work?\"}),uploadFormInputs.references.length>1&&/*#__PURE__*/_jsx(\"button\",{className:\"remove-ref-btn red-box-btn\",onClick:function onClick(event){return handleRefRemove(idx,event);},children:\"-\"}),/*#__PURE__*/_jsx(\"button\",{className:\"add-ref-btn\",onClick:handleRefAdd,children:\"+\"})]},idx);})]})]})})]}),/*#__PURE__*/_jsx(EditCoverPhoto,{coverImageSrc:uploadFormInputs.coverImage,handleImgChange:handleInputChange,handleUpload:handleUpload,saveChanges:saveChanges})]});}export default EditWorkDetails;","map":{"version":3,"sources":["C:/Users/tuu18/Documents/csc309/team63/client/src/components/UploadWorkDetails/EditWorkDetails.js"],"names":["React","useState","EditCoverPhoto","FormRow","SelectCategories","SelectReference","EditWorkDetails","props","defaultSelectedReferences","currentPost","references","map","work","name","id","workId","defaultFormInputs","title","categories","hashtags","tags","audio","description","coverImage","imgSrc","uploadFormInputs","setUploadFormInputs","audioLabel","setAudioLabel","selectedRefWork","setSelectedRefWork","downloads","currentUser","downloadedWorks","artist","saveChanges","setInfo","handleInputChange","event","target","value","split","image","files","URL","createObjectURL","inputs","handleCategoryChange","categoriesList","handleRefAdd","preventDefault","works","handleRefRemove","idx","splice","handleAudioChange","length","console","log","handleRefSelect","selectedWork","handleDescriptionChange","handleUpload","alert","join","ref"],"mappings":"ypBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,MAAOC,CAAAA,cAAP,KAA2B,mBAA3B,CACA,MAAO,cAAP,CACA,MAAOC,CAAAA,OAAP,KAAoB,YAApB,CACA,MAAOC,CAAAA,gBAAP,KAA6B,qBAA7B,CACA,MAAOC,CAAAA,eAAP,KAA4B,oBAA5B,C,wFAIA,QAASC,CAAAA,eAAT,CAA0BC,KAA1B,CAAiC,CAE7B,GAAMC,CAAAA,yBAAyB,CAAGD,KAAK,CAACE,WAAN,CAAkBC,UAAlB,CAA6BC,GAA7B,CAAiC,SAAAC,IAAI,CAAI,CACvE,MAAO,CAACC,IAAI,CAAED,IAAI,CAACC,IAAZ,CAAkBC,EAAE,CAAEF,IAAI,CAACG,MAA3B,CAAP,CACH,CAFiC,CAAlC,CAIA,GAAMC,CAAAA,iBAAiB,CAAG,CACtBC,KAAK,CAAEV,KAAK,CAACE,WAAN,CAAkBQ,KADH,CAEtBP,UAAU,CAAEH,KAAK,CAACE,WAAN,CAAkBC,UAFR,CAGtBQ,UAAU,CAAEX,KAAK,CAACE,WAAN,CAAkBS,UAHR,CAItBC,QAAQ,CAAEZ,KAAK,CAACE,WAAN,CAAkBW,IAJN,CAKtBC,KAAK,CAAEd,KAAK,CAACE,WAAN,CAAkBY,KALH,CAMtBC,WAAW,CAAEf,KAAK,CAACE,WAAN,CAAkBa,WANT,CAOtBC,UAAU,CAAEhB,KAAK,CAACE,WAAN,CAAkBe,MAPR,CAA1B,CAUA,cAAgDvB,QAAQ,CAACe,iBAAD,CAAxD,wCAAOS,gBAAP,eAAyBC,mBAAzB,eACA,eAAoCzB,QAAQ,CAAC,kCAAD,CAA5C,yCAAO0B,UAAP,eAAmBC,aAAnB,eACA,eAA8C3B,QAAQ,CAAC,CAACO,yBAAD,CAAD,CAAtD,yCAAOqB,eAAP,eAAwBC,kBAAxB,eAEA,GAAMC,CAAAA,SAAS,CAAGxB,KAAK,CAACyB,WAAN,CAAkBC,eAAlB,CAAkCtB,GAAlC,CAAsC,SAAAC,IAAI,CAAI,CAC5D,MAAO,CAACC,IAAI,CAAED,IAAI,CAACK,KAAL,CAAa,KAAb,CAAqBL,IAAI,CAACsB,MAAjC,CAAyCpB,EAAE,CAAEF,IAAI,CAACE,EAAlD,CAAP,CAA8D,CADhD,CAAlB,CAGA,GAAMqB,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACtB5B,KAAK,CAAC6B,OAAN,CAAc,CAAC,OAAD,CAAUX,gBAAgB,CAACR,KAA3B,CAAd,EACAV,KAAK,CAAC6B,OAAN,CAAc,CAAC,YAAD,CAAeX,gBAAgB,CAACf,UAAhC,CAAd,EACAH,KAAK,CAAC6B,OAAN,CAAc,CAAC,YAAD,CAAeX,gBAAgB,CAACP,UAAhC,CAAd,EACAX,KAAK,CAAC6B,OAAN,CAAc,CAAC,UAAD,CAAaX,gBAAgB,CAACN,QAA9B,CAAd,EACAZ,KAAK,CAAC6B,OAAN,CAAc,CAAC,OAAD,CAAUX,gBAAgB,CAACJ,KAA3B,CAAd,EACAd,KAAK,CAAC6B,OAAN,CAAc,CAAC,aAAD,CAAgBX,gBAAgB,CAACH,WAAjC,CAAd,EACAf,KAAK,CAAC6B,OAAN,CAAc,CAAC,QAAD,CAAWX,gBAAgB,CAACF,UAA5B,CAAd,EACH,CARD,CAUA,GAAMc,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACC,KAAD,CAAW,CACjC,GAAMzB,CAAAA,IAAI,CAAGyB,KAAK,CAACC,MAAN,CAAa1B,IAA1B,CACA,GAAI2B,CAAAA,KAAJ,CACA,GAAG3B,IAAI,GAAK,UAAZ,CAAwB,CACpB2B,KAAK,CAAGF,KAAK,CAACC,MAAN,CAAaC,KAAb,CAAmBC,KAAnB,CAAyB,OAAzB,CAAR,CACH,CAFD,IAEO,IAAG5B,IAAI,GAAK,YAAZ,CAA0B,CAC7B,GAAM6B,CAAAA,KAAK,CAAGJ,KAAK,CAACC,MAAN,CAAaI,KAAb,CAAmB,CAAnB,CAAd,CACA,GAAGD,KAAH,CAAU,CACNF,KAAK,CAAGI,GAAG,CAACC,eAAJ,CAAoBH,KAApB,CAAR,CACH,CAFD,IAEO,CACH,OACH,CACJ,CAPM,IAQF,CACDF,KAAK,CAAGF,KAAK,CAACC,MAAN,CAAaC,KAArB,CACH,CAEDd,mBAAmB,CAAC,SAAAoB,MAAM,wCAASA,MAAT,wBAAkBjC,IAAlB,CAAyB2B,KAAzB,IAAP,CAAnB,CACH,CAlBD,CAoBA,GAAMO,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACC,cAAD,CAAoB,CAC7C,GAAMnC,CAAAA,IAAI,CAAG,YAAb,CACAa,mBAAmB,CAAC,SAAAoB,MAAM,wCAASA,MAAT,wBAAkBjC,IAAlB,CAAyBmC,cAAzB,IAAP,CAAnB,CACH,CAHD,CAKA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACX,KAAD,CAAW,CAC5BA,KAAK,CAACY,cAAN,GACA,GAAMxC,CAAAA,UAAU,8BAAOe,gBAAgB,CAACf,UAAxB,GAAoC,CAACK,MAAM,CAAE,IAAT,CAAeO,WAAW,CAAE,EAA5B,CAApC,EAAhB,CACA,GAAMT,CAAAA,IAAI,CAAG,YAAb,CACAa,mBAAmB,CAAC,SAAAoB,MAAM,wCAASA,MAAT,wBAAkBjC,IAAlB,CAAyBH,UAAzB,IAAP,CAAnB,CACA,GAAMyC,CAAAA,KAAK,8BAAOtB,eAAP,GAAwB,EAAxB,EAAX,CACAC,kBAAkB,CAACqB,KAAD,CAAlB,CACH,CAPD,CASA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,GAAD,CAAMf,KAAN,CAAgB,CACpCA,KAAK,CAACY,cAAN,GACA,GAAMrC,CAAAA,IAAI,CAAG,YAAb,CACA,GAAIH,CAAAA,UAAU,oBAAOe,gBAAgB,CAACf,UAAxB,CAAd,CACAA,UAAU,CAAC4C,MAAX,CAAkBD,GAAlB,CAAsB,CAAtB,EACA3B,mBAAmB,CAAC,SAAAoB,MAAM,wCAASA,MAAT,wBAAkBjC,IAAlB,CAAyBH,UAAzB,IAAP,CAAnB,CACA,GAAIyC,CAAAA,KAAK,oBAAOtB,eAAP,CAAT,CACAsB,KAAK,CAACG,MAAN,CAAaD,GAAb,CAAiB,CAAjB,EACAvB,kBAAkB,CAACqB,KAAD,CAAlB,CACD,CATH,CAWA,GAAMI,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACjB,KAAD,CAAW,CACjC,GAAGA,KAAK,CAACC,MAAN,CAAaI,KAAb,CAAmBa,MAAtB,CAA6B,CACzBC,OAAO,CAACC,GAAR,CAAYpB,KAAK,CAACC,MAAN,CAAaI,KAAzB,EACA,GAAM9B,CAAAA,IAAI,CAAG,OAAb,CACA,GAAM2B,CAAAA,KAAK,CAAGI,GAAG,CAACC,eAAJ,CAAoBP,KAAK,CAACC,MAAN,CAAaI,KAAb,CAAmB,CAAnB,CAApB,CAAd,CACAjB,mBAAmB,CAAC,SAAAoB,MAAM,wCAASA,MAAT,wBAAkBjC,IAAlB,CAAyB2B,KAAzB,IAAP,CAAnB,CACAZ,aAAa,CAACU,KAAK,CAACC,MAAN,CAAaI,KAAb,CAAmB,CAAnB,EAAsB9B,IAAvB,CAAb,CACH,CACJ,CARD,CAUA,GAAM8C,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACN,GAAD,CAAMtC,MAAN,CAAc6C,YAAd,CAA+B,CACnD,GAAIlD,CAAAA,UAAU,oBAAOe,gBAAgB,CAACf,UAAxB,CAAd,CACAA,UAAU,CAAC2C,GAAD,CAAV,CAAgBtC,MAAhB,CAAyBA,MAAzB,CACA,GAAMF,CAAAA,IAAI,CAAG,YAAb,CACAa,mBAAmB,CAAC,SAAAoB,MAAM,wCAASA,MAAT,wBAAkBjC,IAAlB,CAAyBH,UAAzB,IAAP,CAAnB,CACA,GAAIyC,CAAAA,KAAK,oBAAOtB,eAAP,CAAT,CACAsB,KAAK,CAACE,GAAD,CAAL,CAAaO,YAAb,CACA9B,kBAAkB,CAACqB,KAAD,CAAlB,CACH,CARD,CAUA,GAAMU,CAAAA,uBAAuB,CAAG,QAA1BA,CAAAA,uBAA0B,CAACR,GAAD,CAAMf,KAAN,CAAgB,CAC5C,GAAI5B,CAAAA,UAAU,oBAAOe,gBAAgB,CAACf,UAAxB,CAAd,CACAA,UAAU,CAAC2C,GAAD,CAAV,CAAgB/B,WAAhB,CAA8BgB,KAAK,CAACC,MAAN,CAAaC,KAA3C,CACA,GAAM3B,CAAAA,IAAI,CAAG,YAAb,CACAa,mBAAmB,CAAC,SAAAoB,MAAM,wCAASA,MAAT,wBAAkBjC,IAAlB,CAAyBH,UAAzB,IAAP,CAAnB,CACH,CALD,CAOA,GAAMoD,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACxB,KAAD,CAAW,CAC5BA,KAAK,CAACY,cAAN,GACA;AACAxB,mBAAmB,CAACV,iBAAD,CAAnB,CACAc,kBAAkB,CAAC,CAAC,EAAD,CAAD,CAAlB,CACA,MAAOiC,CAAAA,KAAK,CAAC,qCAAD,CAAZ,CACH,CAND,CAQA,mBACI,aAAK,EAAE,CAAC,kBAAR,wBACI,aAAK,EAAE,CAAC,cAAR,wBACI,YAAK,EAAE,CAAC,kBAAR,uBACI,WAAI,SAAS,CAAC,YAAd,uBADJ,EADJ,cAKI,YAAK,EAAE,CAAC,mBAAR,uBACI,cAAM,EAAE,CAAC,aAAT,wBACI,KAAC,OAAD,EAAS,KAAK,CAAE,OAAhB,CAAyB,IAAI,CAAE,MAA/B,CAAuC,SAAS,CAAE,WAAlD,CAA+D,KAAK,CAAEtC,gBAAgB,CAACR,KAAvF,CACI,YAAY,CAAEoB,iBADlB,CACqC,IAAI,CAAE,OAD3C,EADJ,cAGI,aAHJ,cAII,aAAK,SAAS,CAAC,KAAf,wBACI,cAAO,SAAS,CAAC,aAAjB,wBADJ,cAEI,KAAC,gBAAD,EAAkB,cAAc,CAAEZ,gBAAgB,CAACP,UAAnD,CAA+D,QAAQ,CAAE,KAAzE,CAAgF,YAAY,CAAE6B,oBAA9F,EAFJ,GAJJ,cAQI,aARJ,cASI,KAAC,OAAD,EAAS,KAAK,CAAE,UAAhB,CAA4B,IAAI,CAAE,MAAlC,CAA0C,SAAS,CAAE,WAArD,CAAkE,KAAK,CAAEtB,gBAAgB,CAACN,QAAjB,CAA0B6C,IAA1B,CAA+B,IAA/B,CAAzE,CACI,YAAY,CAAE3B,iBADlB,CACqC,IAAI,CAAE,UAD3C,CACuD,WAAW,CAAE,qBADpE,EATJ,cAWI,aAXJ,cAYI,aAAK,SAAS,CAAC,KAAf,wBACI,cAAO,SAAS,CAAC,aAAjB,wBADJ,cAEI,cAAO,SAAS,CAAC,WAAjB,CAA6B,EAAE,CAAC,kBAAhC,CAAmD,OAAO,CAAC,YAA3D,UAAyEV,UAAzE,EAFJ,cAGI,cAAO,EAAE,CAAC,YAAV,CAAuB,IAAI,CAAC,MAA5B,CAAmC,MAAM,CAAC,YAA1C,CAAuD,QAAQ,CAAE4B,iBAAjE,EAHJ,GAZJ,cAiBI,aAjBJ,cAkBI,aAAK,SAAS,CAAC,KAAf,wBACI,cAAO,SAAS,CAAC,aAAjB,yBADJ,cAEI,iBAAU,SAAS,CAAC,sBAApB,CAA2C,IAAI,CAAC,aAAhD,CAA8D,KAAK,CAAE9B,gBAAgB,CAACH,WAAtF,CAAmG,QAAQ,CAAEe,iBAA7G,EAFJ,GAlBJ,cAsBI,aAtBJ,cAuBI,aAAK,SAAS,CAAC,KAAf,wBACI,cAAO,SAAS,CAAC,aAAjB,8BADJ,CAESZ,gBAAgB,CAACf,UAAjB,CAA4BC,GAA5B,CAAgC,SAACsD,GAAD,CAAMZ,GAAN,CAAc,CAC3C,mBACI,aAAK,SAAS,CAAC,aAAf,wBACI,KAAC,eAAD,EAAiB,OAAO,CAAEtB,SAA1B,CAAqC,eAAe,CAAEF,eAAe,CAACwB,GAAD,CAArE,CACI,YAAY,CAAE,sBAAAO,YAAY,QAAID,CAAAA,eAAe,CAACN,GAAD,CAAMO,YAAY,CAACJ,MAAb,CAAsBI,YAAY,CAAC,CAAD,CAAZ,CAAgB9C,EAAtC,CAA2C,EAAjD,CAAqD8C,YAArD,CAAnB,EAD9B,EADJ,cAGI,iBAAU,SAAS,CAAC,sCAApB,CAA2D,IAAI,CAAC,aAAhE,CAA8E,KAAK,CAAEnC,gBAAgB,CAACf,UAAjB,CAA4B2C,GAA5B,EAAiC/B,WAAtH,CACI,QAAQ,CAAE,kBAAAgB,KAAK,QAAIuB,CAAAA,uBAAuB,CAACR,GAAD,CAAMf,KAAN,CAA3B,EADnB,CAC4D,WAAW,CAAE,4BADzE,EAHJ,CAKKb,gBAAgB,CAACf,UAAjB,CAA4B8C,MAA5B,CAAqC,CAArC,eAA0C,eAAQ,SAAS,CAAC,4BAAlB,CACK,OAAO,CAAE,iBAAAlB,KAAK,QAAIc,CAAAA,eAAe,CAACC,GAAD,CAAMf,KAAN,CAAnB,EADnB,eAL/C,cAOI,eAAQ,SAAS,CAAC,aAAlB,CAAgC,OAAO,CAAEW,YAAzC,eAPJ,GAAkCI,GAAlC,CADJ,CAWH,CAZA,CAFT,GAvBJ,GADJ,EALJ,GADJ,cAiDI,KAAC,cAAD,EAAgB,aAAa,CAAE5B,gBAAgB,CAACF,UAAhD,CAA4D,eAAe,CAAEc,iBAA7E,CAAgG,YAAY,CAAEyB,YAA9G,CAA4H,WAAW,CAAE3B,WAAzI,EAjDJ,GADJ,CAsDH,CAQD,cAAe7B,CAAAA,eAAf","sourcesContent":["import React, { useState } from 'react';\r\nimport EditCoverPhoto from '../EditCoverPhoto';\r\nimport \"./styles.css\";\r\nimport FormRow from '../FormRow';\r\nimport SelectCategories from '../SelectCategories';\r\nimport SelectReference from '../SelectReference';\r\nimport PropTypes from 'prop-types';\r\n\r\n\r\nfunction EditWorkDetails (props) {\r\n\r\n    const defaultSelectedReferences = props.currentPost.references.map(work => {\r\n        return {name: work.name, id: work.workId }\r\n    });\r\n    \r\n    const defaultFormInputs = {\r\n        title: props.currentPost.title,\r\n        references: props.currentPost.references,\r\n        categories: props.currentPost.categories,\r\n        hashtags: props.currentPost.tags,\r\n        audio: props.currentPost.audio,\r\n        description: props.currentPost.description,\r\n        coverImage: props.currentPost.imgSrc\r\n    };\r\n\r\n    const [uploadFormInputs, setUploadFormInputs] = useState(defaultFormInputs);\r\n    const [audioLabel, setAudioLabel] = useState(\"Click this area to select a file\");\r\n    const [selectedRefWork, setSelectedRefWork] = useState([defaultSelectedReferences]);\r\n\r\n    const downloads = props.currentUser.downloadedWorks.map(work => {\r\n        return {name: work.title + \" - \" + work.artist, id: work.id }});\r\n\r\n    const saveChanges = () => {\r\n        props.setInfo(['title', uploadFormInputs.title])\r\n        props.setInfo(['references', uploadFormInputs.references])\r\n        props.setInfo(['categories', uploadFormInputs.categories])\r\n        props.setInfo(['hashtags', uploadFormInputs.hashtags])\r\n        props.setInfo(['audio', uploadFormInputs.audio])\r\n        props.setInfo(['description', uploadFormInputs.description])\r\n        props.setInfo(['imgSrc', uploadFormInputs.coverImage])\r\n    }\r\n\r\n    const handleInputChange = (event) => {\r\n        const name = event.target.name;\r\n        let value;\r\n        if(name === \"hashtags\") {\r\n            value = event.target.value.split(/[ #]+/);\r\n        } else if(name === \"coverImage\") {\r\n            const image = event.target.files[0];\r\n            if(image) {\r\n                value = URL.createObjectURL(image);\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n        else {\r\n            value = event.target.value;\r\n        }\r\n\r\n        setUploadFormInputs(inputs => ({...inputs, [name]: value}));\r\n    };\r\n\r\n    const handleCategoryChange = (categoriesList) => {\r\n        const name = 'categories';\r\n        setUploadFormInputs(inputs => ({...inputs, [name]: categoriesList}));\r\n    };\r\n\r\n    const handleRefAdd = (event) => {\r\n        event.preventDefault();\r\n        const references = [...uploadFormInputs.references, {workId: null, description: \"\"}];\r\n        const name = 'references';\r\n        setUploadFormInputs(inputs => ({...inputs, [name]: references}));\r\n        const works = [...selectedRefWork, []];\r\n        setSelectedRefWork(works);\r\n    }\r\n\r\n    const handleRefRemove = (idx, event) => {\r\n        event.preventDefault();\r\n        const name = 'references';\r\n        let references = [...uploadFormInputs.references];\r\n        references.splice(idx,1);\r\n        setUploadFormInputs(inputs => ({...inputs, [name]: references}));\r\n        let works = [...selectedRefWork];\r\n        works.splice(idx,1);\r\n        setSelectedRefWork(works);\r\n      }\r\n\r\n    const handleAudioChange = (event) => {\r\n        if(event.target.files.length){\r\n            console.log(event.target.files);\r\n            const name = \"audio\";\r\n            const value = URL.createObjectURL(event.target.files[0]);\r\n            setUploadFormInputs(inputs => ({...inputs, [name]: value}));\r\n            setAudioLabel(event.target.files[0].name);\r\n        }\r\n    }\r\n\r\n    const handleRefSelect = (idx, workId, selectedWork) => {\r\n        let references = [...uploadFormInputs.references];\r\n        references[idx].workId = workId;\r\n        const name = 'references';\r\n        setUploadFormInputs(inputs => ({...inputs, [name]: references}));\r\n        let works = [...selectedRefWork];\r\n        works[idx] = selectedWork;\r\n        setSelectedRefWork(works);\r\n    }\r\n\r\n    const handleDescriptionChange = (idx, event) => {\r\n        let references = [...uploadFormInputs.references];\r\n        references[idx].description = event.target.value;\r\n        const name = 'references';\r\n        setUploadFormInputs(inputs => ({...inputs, [name]: references}));\r\n    }\r\n\r\n    const handleUpload = (event) => {\r\n        event.preventDefault();\r\n        //a post request will be made with the form data\r\n        setUploadFormInputs(defaultFormInputs);\r\n        setSelectedRefWork([[]]);\r\n        return alert(\"Your work was successfully uploaded\");\r\n    }\r\n\r\n    return(\r\n        <div id=\"edit-upload-page\"> \r\n            <div id=\"work-details\">\r\n                <div id=\"header-container\">\r\n                    <h2 className=\"page-title\">Edit Post</h2>\r\n                </div>\r\n\r\n                <div id=\"details-container\">\r\n                    <form id=\"upload-form\">\r\n                        <FormRow label={\"Title\"} type={\"text\"} className={\"input-box\"} value={uploadFormInputs.title} \r\n                            handleChange={handleInputChange} name={\"title\"}/>\r\n                        <br/>\r\n                        <div className=\"row\">\r\n                            <label className=\"input-label\">Categories</label>\r\n                            <SelectCategories selectedValues={uploadFormInputs.categories} disabled={false} handleSelect={handleCategoryChange}/>\r\n                        </div>\r\n                        <br/>\r\n                        <FormRow label={\"Hashtags\"} type={\"text\"} className={\"input-box\"} value={uploadFormInputs.hashtags.join(\" #\")} \r\n                            handleChange={handleInputChange} name={\"hashtags\"} placeholder={\"#hashtag1 #hashtag2\"}/>\r\n                        <br/>\r\n                        <div className=\"row\">\r\n                            <label className=\"input-label\">Audio File</label>\r\n                            <label className=\"input-box\" id=\"audio-file-label\" htmlFor=\"audio-file\">{audioLabel}</label>\r\n                            <input id=\"audio-file\" type=\"file\" accept=\".mp3, .wav\" onChange={handleAudioChange}/>\r\n                        </div>\r\n                        <br/>\r\n                        <div className=\"row\">\r\n                            <label className=\"input-label\">Description</label>\r\n                            <textarea className=\"description-text-box\" name=\"description\" value={uploadFormInputs.description} onChange={handleInputChange}/>\r\n                        </div>\r\n                        <br/>\r\n                        <div className=\"row\">\r\n                            <label className=\"input-label\">Referenced Works</label>\r\n                                {uploadFormInputs.references.map((ref, idx) => {\r\n                                    return (\r\n                                        <div className=\"add-ref-box\" key={idx}> \r\n                                            <SelectReference options={downloads} selectedOptions={selectedRefWork[idx]}\r\n                                                handleSelect={selectedWork => handleRefSelect(idx, selectedWork.length ? selectedWork[0].id : \"\", selectedWork)}/>\r\n                                            <textarea className=\"description-text-box ref-description\" name=\"description\" value={uploadFormInputs.references[idx].description}\r\n                                                onChange={event => handleDescriptionChange(idx, event)} placeholder={\"How did you use this work?\"}/>\r\n                                            {uploadFormInputs.references.length > 1 && <button className=\"remove-ref-btn red-box-btn\"\r\n                                                                                            onClick={event => handleRefRemove(idx, event)}>-</button>}\r\n                                            <button className=\"add-ref-btn\" onClick={handleRefAdd}>+</button>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n            <EditCoverPhoto coverImageSrc={uploadFormInputs.coverImage} handleImgChange={handleInputChange} handleUpload={handleUpload} saveChanges={saveChanges}/>\r\n        </div>\r\n    );\r\n\r\n}\r\n\r\nEditWorkDetails.propTypes = {\r\n    currentUser: PropTypes.object,\r\n    currentPost: PropTypes.object,\r\n    setInfo: PropTypes.func\r\n};\r\n\r\nexport default EditWorkDetails;"]},"metadata":{},"sourceType":"module"}